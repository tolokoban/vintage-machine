"use strict";
self["webpackHotUpdatevintage_machine"]("app",{

/***/ 4658:
/*!******************************!*\
  !*** ./src/kernel/kernel.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Kernel: () => (/* binding */ Kernel)
/* harmony export */ });
/* harmony import */ var _tolokoban_tgd__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @tolokoban/tgd */ 953);

class Kernel extends _tolokoban_tgd__WEBPACK_IMPORTED_MODULE_0__.TgdPainter {
    constructor(canvas, symbols) {
        super();
        this.variables = new Map();
        this.layersSwaps = [[], []];
        this.layersIndexes = [];
        this._currentLayer = 0;
        this.paintLayer = (time, delay) => { };
        canvas.width = Kernel.WIDTH;
        canvas.height = Kernel.HEIGHT;
        const context = new _tolokoban_tgd__WEBPACK_IMPORTED_MODULE_0__.TgdContext(canvas, {
            alpha: true,
            antialias: false,
            preserveDrawingBuffer: true,
        });
        this.context = context;
        this.framebuffer = new _tolokoban_tgd__WEBPACK_IMPORTED_MODULE_0__.TgdPainterFramebuffer(context, { children: [
                new _tolokoban_tgd__WEBPACK_IMPORTED_MODULE_0__.TgdPainterLogic(this.paintLayer)
            ] });
        for (let index = 0; index < Kernel.LAYERS_COUNT; index++) {
            for (const layers of this.layersSwaps) {
                layers.push(new _tolokoban_tgd__WEBPACK_IMPORTED_MODULE_0__.TgdTexture2D(context).setParams({
                    wrapS: "REPEAT",
                    wrapT: "REPEAT",
                    magFilter: "NEAREST",
                    minFilter: "NEAREST",
                }));
            }
            this.layersIndexes.push(0);
        }
        context.add(this);
        context.paint();
    }
    get currentLayer() {
        return this._currentLayer;
    }
    set currentLayer(value) {
        value =
            Kernel.LAYERS_COUNT === 1
                ? 0
                : (0,_tolokoban_tgd__WEBPACK_IMPORTED_MODULE_0__.tgdCalcModulo)(Math.round(value), 0, Kernel.LAYERS_COUNT - 1);
        this._currentLayer = value;
    }
    delete() {
        this.framebuffer.delete();
        for (const layers of this.layersSwaps) {
            for (const layer of layers) {
                layer.delete();
            }
        }
    }
    paint(time, delay) {
        const { context } = this;
        const { gl } = context;
        gl.clearColor(1, 0.667, 0, 1);
        gl.clear(gl.COLOR_BUFFER_BIT);
    }
    getVar(name) {
        var _a;
        return (_a = this.variables.get(name)) !== null && _a !== void 0 ? _a : 0;
    }
    setVar(name, value) {
        this.variables.set(name, value);
    }
    debugVariables() {
        for (const key of this.variables.keys()) {
            console.log(key, "=", this.getVar(key));
        }
    }
}
Kernel.LAYERS_COUNT = 1;
Kernel.WIDTH = 640;
Kernel.HEIGHT = 480;


/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("5dd0141509f14eb06a8d")
/******/ })();
/******/ 
/******/ }
);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmM3MDgwMmY2ZGE1MjFhMDdlYzNjLmhvdC11cGRhdGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFRd0I7QUFFakIsTUFBTSxNQUFPLFNBQVEsc0RBQVU7SUFZcEMsWUFBWSxNQUF5QixFQUFFLE9BQW9CO1FBQ3pELEtBQUssRUFBRSxDQUFDO1FBUE8sY0FBUyxHQUFHLElBQUksR0FBRyxFQUFzQixDQUFDO1FBQzFDLGdCQUFXLEdBQXFDLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBQ3pELGtCQUFhLEdBQWEsRUFBRSxDQUFDO1FBRXRDLGtCQUFhLEdBQUcsQ0FBQyxDQUFDO1FBMkRULGVBQVUsR0FBRyxDQUFDLElBQVksRUFBRSxLQUFhLEVBQVEsRUFBRSxHQUFFLENBQUM7UUF2RHJFLE1BQU0sQ0FBQyxLQUFLLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQztRQUM1QixNQUFNLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUM7UUFDOUIsTUFBTSxPQUFPLEdBQUcsSUFBSSxzREFBVSxDQUFDLE1BQU0sRUFBRTtZQUNyQyxLQUFLLEVBQUUsSUFBSTtZQUNYLFNBQVMsRUFBRSxLQUFLO1lBQ2hCLHFCQUFxQixFQUFFLElBQUk7U0FDNUIsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7UUFDdkIsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLGlFQUFxQixDQUFDLE9BQU8sRUFBRSxFQUFDLFFBQVEsRUFBRTtnQkFDN0QsSUFBSSwyREFBZSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUM7YUFDdkMsRUFBQyxDQUFDO1FBQ0gsS0FBSyxJQUFJLEtBQUssR0FBRyxDQUFDLEVBQUUsS0FBSyxHQUFHLE1BQU0sQ0FBQyxZQUFZLEVBQUUsS0FBSyxFQUFFLEVBQUUsQ0FBQztZQUN6RCxLQUFLLE1BQU0sTUFBTSxJQUFJLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztnQkFDdEMsTUFBTSxDQUFDLElBQUksQ0FDVCxJQUFJLHdEQUFZLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxDQUFDO29CQUNsQyxLQUFLLEVBQUUsUUFBUTtvQkFDZixLQUFLLEVBQUUsUUFBUTtvQkFDZixTQUFTLEVBQUUsU0FBUztvQkFDcEIsU0FBUyxFQUFFLFNBQVM7aUJBQ3JCLENBQUMsQ0FDSCxDQUFDO1lBQ0osQ0FBQztZQUNELElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdCLENBQUM7UUFDRCxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2xCLE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUNsQixDQUFDO0lBRUQsSUFBSSxZQUFZO1FBQ2QsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDO0lBQzVCLENBQUM7SUFDRCxJQUFJLFlBQVksQ0FBQyxLQUFhO1FBQzVCLEtBQUs7WUFDSCxNQUFNLENBQUMsWUFBWSxLQUFLLENBQUM7Z0JBQ3ZCLENBQUMsQ0FBQyxDQUFDO2dCQUNILENBQUMsQ0FBQyw2REFBYSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxZQUFZLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDbkUsSUFBSSxDQUFDLGFBQWEsR0FBRyxLQUFLLENBQUM7SUFDN0IsQ0FBQztJQUVELE1BQU07UUFDRixJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sRUFBRTtRQUMzQixLQUFLLE1BQU0sTUFBTSxJQUFJLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUN0QyxLQUFLLE1BQU0sS0FBSyxJQUFJLE1BQU0sRUFBRSxDQUFDO2dCQUMzQixLQUFLLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDakIsQ0FBQztRQUNILENBQUM7SUFDSCxDQUFDO0lBRUQsS0FBSyxDQUFDLElBQVksRUFBRSxLQUFhO1FBQy9CLE1BQU0sRUFBRSxPQUFPLEVBQUUsR0FBRyxJQUFJLENBQUM7UUFDekIsTUFBTSxFQUFFLEVBQUUsRUFBRSxHQUFHLE9BQU8sQ0FBQztRQUN2QixFQUFFLENBQUMsVUFBVSxDQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQzlCLEVBQUUsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLGdCQUFnQixDQUFDLENBQUM7SUFDaEMsQ0FBQztJQUlELE1BQU0sQ0FBQyxJQUFZOztRQUNqQixPQUFPLFVBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxtQ0FBSSxDQUFDLENBQUM7SUFDdkMsQ0FBQztJQUVELE1BQU0sQ0FBQyxJQUFZLEVBQUUsS0FBaUI7UUFDcEMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFFRCxjQUFjO1FBQ1osS0FBSyxNQUFNLEdBQUcsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUM7WUFDeEMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUMxQyxDQUFDO0lBQ0gsQ0FBQzs7QUFsRmUsbUJBQVksR0FBRyxDQUFDLENBQUM7QUFDakIsWUFBSyxHQUFHLEdBQUcsQ0FBQztBQUNaLGFBQU0sR0FBRyxHQUFHLENBQUM7Ozs7Ozs7OztVQ2IvQiIsInNvdXJjZXMiOlsiL2hvbWUvdG9sb2tvYmFuL0NvZGUvZ2l0aHViL2dhbWUvZ2FtZXMvdmludGFnZS1tYWNoaW5lL3NyYy9rZXJuZWwva2VybmVsLnRzIiwid2VicGFjay9ydW50aW1lL2dldEZ1bGxIYXNoIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJhc2lrVmFsdWUgfSBmcm9tIFwiQC90eXBlc1wiO1xuaW1wb3J0IHtcbiAgdGdkQ2FsY01vZHVsbyxcbiAgVGdkQ29udGV4dCxcbiAgVGdkUGFpbnRlcixcbiAgVGdkUGFpbnRlckZyYW1lYnVmZmVyLFxuICBUZ2RQYWludGVyTG9naWMsXG4gIFRnZFRleHR1cmUyRCxcbn0gZnJvbSBcIkB0b2xva29iYW4vdGdkXCI7XG5cbmV4cG9ydCBjbGFzcyBLZXJuZWwgZXh0ZW5kcyBUZ2RQYWludGVyIHtcbiAgc3RhdGljIHJlYWRvbmx5IExBWUVSU19DT1VOVCA9IDE7XG4gIHN0YXRpYyByZWFkb25seSBXSURUSCA9IDY0MDtcbiAgc3RhdGljIHJlYWRvbmx5IEhFSUdIVCA9IDQ4MDtcblxuICBwcml2YXRlIHJlYWRvbmx5IGNvbnRleHQ6IFRnZENvbnRleHQ7XG4gIHByaXZhdGUgcmVhZG9ubHkgdmFyaWFibGVzID0gbmV3IE1hcDxzdHJpbmcsIEJhc2lrVmFsdWU+KCk7XG4gIHByaXZhdGUgcmVhZG9ubHkgbGF5ZXJzU3dhcHM6IFtUZ2RUZXh0dXJlMkRbXSwgVGdkVGV4dHVyZTJEW11dID0gW1tdLCBbXV07XG4gIHByaXZhdGUgcmVhZG9ubHkgbGF5ZXJzSW5kZXhlczogbnVtYmVyW10gPSBbXTtcbiAgcHJpdmF0ZSByZWFkb25seSBmcmFtZWJ1ZmZlcjogVGdkUGFpbnRlckZyYW1lYnVmZmVyXG4gIHByaXZhdGUgX2N1cnJlbnRMYXllciA9IDA7XG5cbiAgY29uc3RydWN0b3IoY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCwgc3ltYm9sczogQXJyYXlCdWZmZXIpIHtcbiAgICBzdXBlcigpO1xuICAgIGNhbnZhcy53aWR0aCA9IEtlcm5lbC5XSURUSDtcbiAgICBjYW52YXMuaGVpZ2h0ID0gS2VybmVsLkhFSUdIVDtcbiAgICBjb25zdCBjb250ZXh0ID0gbmV3IFRnZENvbnRleHQoY2FudmFzLCB7XG4gICAgICBhbHBoYTogdHJ1ZSxcbiAgICAgIGFudGlhbGlhczogZmFsc2UsXG4gICAgICBwcmVzZXJ2ZURyYXdpbmdCdWZmZXI6IHRydWUsXG4gICAgfSk7XG4gICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgICB0aGlzLmZyYW1lYnVmZmVyID0gbmV3IFRnZFBhaW50ZXJGcmFtZWJ1ZmZlcihjb250ZXh0LCB7Y2hpbGRyZW46IFtcbiAgICAgICAgbmV3IFRnZFBhaW50ZXJMb2dpYyh0aGlzLnBhaW50TGF5ZXIpXG4gICAgXX0pXG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IEtlcm5lbC5MQVlFUlNfQ09VTlQ7IGluZGV4KyspIHtcbiAgICAgIGZvciAoY29uc3QgbGF5ZXJzIG9mIHRoaXMubGF5ZXJzU3dhcHMpIHtcbiAgICAgICAgbGF5ZXJzLnB1c2goXG4gICAgICAgICAgbmV3IFRnZFRleHR1cmUyRChjb250ZXh0KS5zZXRQYXJhbXMoe1xuICAgICAgICAgICAgd3JhcFM6IFwiUkVQRUFUXCIsXG4gICAgICAgICAgICB3cmFwVDogXCJSRVBFQVRcIixcbiAgICAgICAgICAgIG1hZ0ZpbHRlcjogXCJORUFSRVNUXCIsXG4gICAgICAgICAgICBtaW5GaWx0ZXI6IFwiTkVBUkVTVFwiLFxuICAgICAgICAgIH0pLFxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgdGhpcy5sYXllcnNJbmRleGVzLnB1c2goMCk7XG4gICAgfVxuICAgIGNvbnRleHQuYWRkKHRoaXMpO1xuICAgIGNvbnRleHQucGFpbnQoKTtcbiAgfVxuXG4gIGdldCBjdXJyZW50TGF5ZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRMYXllcjtcbiAgfVxuICBzZXQgY3VycmVudExheWVyKHZhbHVlOiBudW1iZXIpIHtcbiAgICB2YWx1ZSA9XG4gICAgICBLZXJuZWwuTEFZRVJTX0NPVU5UID09PSAxXG4gICAgICAgID8gMFxuICAgICAgICA6IHRnZENhbGNNb2R1bG8oTWF0aC5yb3VuZCh2YWx1ZSksIDAsIEtlcm5lbC5MQVlFUlNfQ09VTlQgLSAxKTtcbiAgICB0aGlzLl9jdXJyZW50TGF5ZXIgPSB2YWx1ZTtcbiAgfVxuXG4gIGRlbGV0ZSgpOiB2b2lkIHtcbiAgICAgIHRoaXMuZnJhbWVidWZmZXIuZGVsZXRlKClcbiAgICBmb3IgKGNvbnN0IGxheWVycyBvZiB0aGlzLmxheWVyc1N3YXBzKSB7XG4gICAgICBmb3IgKGNvbnN0IGxheWVyIG9mIGxheWVycykge1xuICAgICAgICBsYXllci5kZWxldGUoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwYWludCh0aW1lOiBudW1iZXIsIGRlbGF5OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCB7IGNvbnRleHQgfSA9IHRoaXM7XG4gICAgY29uc3QgeyBnbCB9ID0gY29udGV4dDtcbiAgICBnbC5jbGVhckNvbG9yKDEsIDAuNjY3LCAwLCAxKTtcbiAgICBnbC5jbGVhcihnbC5DT0xPUl9CVUZGRVJfQklUKTtcbiAgfVxuXG4gIHByaXZhdGUgcmVhZG9ubHkgcGFpbnRMYXllciA9ICh0aW1lOiBudW1iZXIsIGRlbGF5OiBudW1iZXIpOiB2b2lkID0+IHt9XG5cbiAgZ2V0VmFyKG5hbWU6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLnZhcmlhYmxlcy5nZXQobmFtZSkgPz8gMDtcbiAgfVxuXG4gIHNldFZhcihuYW1lOiBzdHJpbmcsIHZhbHVlOiBCYXNpa1ZhbHVlKSB7XG4gICAgdGhpcy52YXJpYWJsZXMuc2V0KG5hbWUsIHZhbHVlKTtcbiAgfVxuXG4gIGRlYnVnVmFyaWFibGVzKCkge1xuICAgIGZvciAoY29uc3Qga2V5IG9mIHRoaXMudmFyaWFibGVzLmtleXMoKSkge1xuICAgICAgY29uc29sZS5sb2coa2V5LCBcIj1cIiwgdGhpcy5nZXRWYXIoa2V5KSk7XG4gICAgfVxuICB9XG59XG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmggPSAoKSA9PiAoXCI1ZGQwMTQxNTA5ZjE0ZWIwNmE4ZFwiKSJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==